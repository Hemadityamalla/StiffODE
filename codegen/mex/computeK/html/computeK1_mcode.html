<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">kr</span> = computeK(<span class="var type1" id="S3T2U6">order</span>,<span class="var type1" id="S4T2U7">eqNo</span>,<span class="var type1" id="S5T2U8">i</span>,<span class="var type1" id="S6T3U9">f</span>,<span class="var type1" id="S7T2U10">h</span>,<span class="var type1" id="S8T4U11">y</span>,<span class="var type1" id="S9T5U12">x</span>,<span class="var type1" id="S10T6U13">J</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line">    <span class="mxinfo " id="T1:U10"><span class="var type1" id="S2T1U16">kr</span> = <span class="mxinfo " id="T1:U12">zeros(<span class="var type1" id="S3T2U19">order</span>,<span class="var type1" id="S4T2U20">eqNo</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">    <span class="mxinfo " id="T2:U15"><span class="var type1" id="S12T2U23">gamma</span> = <span class="mxinfo " id="T2:U17"><span class="mxinfo " id="T2:U18">1.0</span> + <span class="mxinfo " id="T2:U19"><span class="mxinfo " id="T2:U20">1</span>/<span class="mxinfo " id="T2:U21">sqrt(2.0)</span></span></span></span>; <span class="comment">%chosen such that the scheme is stable for larger step sizes.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">    <span class="mxinfo " id="T2:U22"><span class="var type1" id="S14T2U33">dx</span> = <span class="mxinfo " id="T2:U24">1e-5</span></span>; <span class="comment">%Used to estimate the derivative</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">    <span class="mxinfo " id="T7:U25"><span class="var type1" id="S15T7U37">b</span> = <span class="mxinfo " id="T7:U27">zeros(<span class="var type1" id="S4T2U40">eqNo</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo " id="T7:U29"><span class="var type1" id="S16T7U44">dfdt</span> = <span class="mxinfo " id="T7:U31">zeros(<span class="var type1" id="S4T2U47">eqNo</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">        <span class="comment">%First slope- k1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S17T2U51">ii</span>=<span class="mxinfo " id="T7:U34"><span class="mxinfo " id="T2:U35">1</span>:<span class="var type1" id="S4T2U54">eqNo</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">        <span class="var type0" id="S16T0U58">dfdt</span>(<span class="var type0" id="S17T0U59">ii</span>,1) = (<span class="message error" id="M1F1C"><span class="var type1" id="S6T3U66">f</span>{<span class="var type0" id="S17T0U67">ii</span>}</span>(<span class="var type0" id="S9T0U70">x</span>(<span class="var type0" id="S5T0U72">i</span>-1)+<span class="var type0" id="S14T0U74">dx</span>,<span class="var type0" id="S8T0U76">y</span>(<span class="var type0" id="S5T0U78">i</span>-1,:)) - <span class="var type0" id="S6T0U83">f</span>{<span class="var type0" id="S17T0U84">ii</span>}(<span class="var type0" id="S9T0U86">x</span>(<span class="var type0" id="S5T0U88">i</span>-1),<span class="var type0" id="S8T0U91">y</span>(<span class="var type0" id="S5T0U93">i</span>-1,:)))/<span class="var type0" id="S14T0U96">dx</span>;<span class="comment">%Maybe replace this by the derivative function in DERIVSUITE </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">        <span class="var type0" id="S15T0U100">b</span>(<span class="var type0" id="S17T0U101">ii</span>,1) = <span class="message error" id="M2F1C"><span class="var type1" id="S6T3U105">f</span>{<span class="var type0" id="S17T0U106">ii</span>}</span>(<span class="var type0" id="S9T0U108">x</span>(<span class="var type0" id="S5T0U110">i</span>-1),<span class="var type0" id="S8T0U113">y</span>(<span class="var type0" id="S5T0U115">i</span>-1,:)); <span class="comment">%Extra term arises for a non-autonomous case</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T8:U39"><span class="mxinfo " id="T8:U40"><span class="var type1" id="S2T1U121">kr</span>(<span class="mxinfo " id="T2:U42">1</span>,<span class="mxinfo " id="T9:U43">:</span>)</span> = <span class="mxinfo " id="T10:U44">(<span class="mxinfo " id="T6:U45"><span class="mxinfo " id="T6:U46">eye(<span class="mxinfo " id="T11:U47">length(<span class="var type1" id="S10T6U131">J</span>)</span>)</span> - <span class="mxinfo " id="T6:U49"><span class="mxinfo " id="T2:U50"><span class="var type1" id="S7T2U134">h</span>*<span class="var type1" id="S12T2U135">gamma</span></span>*<span class="var type1" id="S10T6U136">J</span></span></span>)\<span class="var type1" id="S15T7U137">b</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">        <span class="comment">%Second slope- k2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S17T2U140">ii</span>=<span class="mxinfo " id="T7:U56"><span class="mxinfo " id="T2:U57">1</span>:<span class="var type1" id="S4T2U143">eqNo</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">        <span class="var type0" id="S15T0U147">b</span>(<span class="var type0" id="S17T0U148">ii</span>,1) = <span class="message error" id="M3F1C"><span class="var type1" id="S6T3U153">f</span>{<span class="var type0" id="S17T0U154">ii</span>}</span>(<span class="var type0" id="S9T0U157">x</span>(<span class="var type0" id="S5T0U159">i</span>-1)+<span class="var type0" id="S7T0U161">h</span>,<span class="var type0" id="S8T0U164">y</span>(<span class="var type0" id="S5T0U166">i</span>-1,:)+<span class="var type0" id="S7T0U170">h</span>*<span class="var type0" id="S2T0U172">kr</span>(1,<span class="var type0" id="S17T0U174">ii</span>)) - 2*<span class="var type0" id="S2T0U178">kr</span>(1,<span class="var type0" id="S17T0U180">ii</span>); <span class="comment">%Extra term arises for the non-autonomous case.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T8:U60"><span class="mxinfo " id="T8:U61"><span class="var type1" id="S2T1U184">kr</span>(<span class="mxinfo " id="T2:U63">2</span>,<span class="mxinfo " id="T9:U64">:</span>)</span> = <span class="mxinfo " id="T10:U65">(<span class="mxinfo " id="T6:U66"><span class="mxinfo " id="T6:U67">eye(<span class="mxinfo " id="T11:U68">length(<span class="var type1" id="S10T6U194">J</span>)</span>)</span> - <span class="mxinfo " id="T6:U70"><span class="mxinfo " id="T2:U71"><span class="var type1" id="S7T2U197">h</span>*<span class="var type1" id="S12T2U198">gamma</span></span>*<span class="var type1" id="S10T6U199">J</span></span></span>)\<span class="var type1" id="S15T7U200">b</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
